## Описание изменений

{Краткое описание того, что было сделано}

**Важно**: Описание PR должно быть на **русском языке**, UTF-8, без моджибаке. Это правило проекта для единообразия и удобства команды.

**Связанная задача**: {Ссылка на Notion Briefs или GitHub Issue}

---

## Deliverables

**Исполнитель**: {Имя агента или исполнителя, например: Cursor, GitHub Copilot}  
**Статус**: ✅ Выполнено | ⏳ В процессе | ❌ Заблокировано  
**Задача**: {Ссылка на задачу в Notion Briefs или Issue}

### Выполнено
- [ ] {Пункт 1 из списка Deliverables из Briefs}
- [ ] {Пункт 2 из списка Deliverables из Briefs}

### Изменения
- {Описание изменений 1}
- {Описание изменений 2}

### Изменённые файлы
- `path/to/file1.md` — {описание изменений}
- `path/to/file2.js` — {описание изменений}

### Созданные PR
- {Номер PR} — {название PR} (если создавались связанные PR)

### Метрики

**Примечание**: Заполняйте метрики, если они применимы к вашему PR. Для автоматического сбора метрик CI используйте `npm run ci:metrics:collect`.

#### CI и производительность
- **Время выполнения CI**: {например: "Draft PR: ~2 мин, Ready PR: ~6 мин"}
- **Статус jobs**: {например: "Все jobs успешны, 0 failures"}
- **Самый медленный job**: {например: "diagnostics-full: 3.5 мин"}

#### Диагностика и качество
- **Диагностика**: {например: "internal-missing: 0, service: 5, external: 104"}
- **Orphan pages**: {например: "Добавлено 0 новых orphan страниц"}
- **Готовность контента**: {например: "ready: 150, draft: 45"}

#### Контент и структура
- **Созданные файлы**: {например: "Создано 5 новых файлов"}
- **Изменённые файлы**: {например: "Изменено 12 файлов"}
- **Исправленные ссылки**: {например: "Исправлено 10 битых ссылок"}
- **Добавленные термины**: {например: "Добавлено 3 новых термина в KB"}

#### Размер изменений
- **Строки кода**: {например: "+523 строк, -117 строк"}
- **Размер PR**: {например: "15 файлов изменено"}

### Проблемы
- {Проблема 1, если была, например: "Конфликт с веткой main"}
- {Проблема 2, если была}

### Предложения
- {Предложение по улучшению, если есть, например: "Добавить автоматическую проверку Deliverables в CI"}

---

## Two-stream синхронизация

**Two-stream Policy**: 
- [ ] Stream 2 (GitHub → Notion): Работа агента с синхронизацией статусов в Notion

**Статус синхронизации**:
- [ ] Статус в Notion обновлён на `In Progress` (при создании ветки)
- [ ] Статус в Notion обновлён на `Review` (при создании PR)
- [ ] Статус в Notion будет обновлён на `Done` (после мерджа)

**Примечания по синхронизации**:
{Если работа связана с Notion, укажите:}
- **Notion Page ID**: {ID страницы задачи в Notion, если применимо}
- **Метод синхронизации**: {MCP / Scripts / Manual}
- **Статус обновлён**: {Да/Нет — обновлён ли статус в Notion}
- **Проблемы**: {Проблемы с синхронизацией, если были}

---

## Terms found

{Для PR по Stories — обязательный блок. Для других PR — можно удалить этот раздел.}

Термины извлечены из файлов Stories для добавления в KB:

- **Термин** (`slug`)
  > Цитата контекста 1 (до 150 символов)
  > Цитата контекста 2 (до 150 символов, опционально)

{Сгенерировать через: `npm run terms:found`}

Подробнее см. [Terms found — формат блока в PR по Stories](docs/TERMS-FOUND-FORMAT.md).

---

## Метки и классификация

**Lane Label**: {Добавьте соответствующий label при создании PR}

**Standard lanes**: `lane:docs`, `lane:infra`, `lane:stories`, `lane:characters`, `lane:qa`, `lane:refactor`, `lane:fix`, `lane:feat`, `lane:composer`

**Copilot lanes**: `lane:copilot`, `lane:copilot:docs`, `lane:copilot:infra`, `lane:copilot:stories`, `lane:copilot:refactor`, `lane:copilot:feat`, `lane:copilot:fix`

**Sequence Label**: {Если задача является частью последовательности, добавьте `seq:1`, `seq:2`, `seq:3`, и т.д. (до `seq:15`)}

---

## Чек-лист проверки

### ⚠️ ОБЯЗАТЕЛЬНО ПОСЛЕ ПРАВОК И ПЕРЕЗАПУСКА PR
- [ ] **Удалены старые комментарии ботов**: Выполнена команда `npm run pr:rerun -- --pr=<номер>` для удаления всех старых комментариев от ботов (GitHub Actions). Комментарии Cursor Bugbot сохраняются. Комментарии становятся "старыми" после внесения правок и перезапуска проверок — их нужно удалить, чтобы PR содержал только актуальные комментарии без уже исправленных ошибок.

### Общие проверки
- [ ] Front matter присутствует в изменённых .md файлах
- [ ] slug соответствует имени файла
- [ ] Ссылки относительные (без percent-encoding)
- [ ] notion_page_id + last_edited_time присутствуют (если применимо)
- [ ] Изменены только разрешённые пути (.github/ **или** docs/ **или** prototype/ **или** scripts/)
- [ ] Секция Deliverables заполнена в PR описании
- [ ] Все пункты из Briefs отмечены как Completed или объяснено, почему нет
- [ ] Добавлен соответствующий lane label (`lane:*`) для автоматической проверки конфликтов
- [ ] Проверка размера PR пройдена (`npm run check:pr-size`)
- [ ] Проверка lanes policy пройдена (`npm run check:lanes`)

### Прототип (если изменялись prototype/ или docs/)
- [ ] Rebuild diagnostics выполнен (`npm run diagnostics:snapshot`)
- [ ] Проверено обновление `prototype/data/pages.json`
- [ ] Проверено обновление `prototype/data/orphans.json` (если изменялись routes.yml)
- [ ] Проверено обновление `prototype/data/stats.json`
- [ ] Проверено обновление `prototype/data/broken-links.json`

### Orphan pages (если добавлялись новые страницы в docs/)
- [ ] Проверен список orphan страниц (`npm run routes:check`)
- [ ] Новые страницы добавлены в `routes.yml` (если они не служебные)
- [ ] Или страницы помечены как `service: true` в front matter (если они служебные)
- [ ] Проверено отображение в Explorer → Orphans view (должно быть пусто для публичных страниц)

### Lanes policy
- [ ] Добавлен соответствующий `lane:*` label к PR
- [ ] Проверка one-PR-per-lane пройдена (CI должен быть зелёным)
- [ ] Нет конфликтов с другими открытыми PR в той же lane

### Качество контента
- [ ] Summary не пустой и не превышает 300 символов
- [ ] Контент не превышает 50,000 символов (предупреждение) или 100,000 символов (ошибка)
- [ ] Нет PII (пути пользователей, email, телефоны) в контенте
- [ ] Линтер пройден (`npm run lint:docs`)

### Проверки перед PR
- [ ] Нормализатор не меняет файл «сам по себе» при повторном запуске (`npm run normalize:dry`)
- [ ] Проверка PII выполнена (`npm run pii:scan`)
- [ ] Все команды выполнены перед открытием PR
- [ ] Нумерация PR проверена

---

## Связанные документы

- [Single Source Playbook](docs/SINGLE-SOURCE-PLAYBOOK.md) — правила работы с PR и синхронизацией
- [Terms found — формат блока](docs/TERMS-FOUND-FORMAT.md) — формат блока Terms found для Stories PR
- [CONTRIBUTING.stories.md](docs/CONTRIBUTING.stories.md) — гайд для авторов Stories
