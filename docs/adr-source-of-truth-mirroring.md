---
title: ADR — Source of truth и зеркалирование
slug: adr-source-of-truth-mirroring
summary: >-
  Закрепляем, что Notion остаётся авторским источником, а GitHub —
  контролируемым зеркалом с проверяемым импортом.
tags:
  - Автоматизация
  - Кодинг
  - Проектирование
machine_tags:
  - action/build
  - product/services
  - theme/automation
  - theme/dev
  - theme/graphics
status: ready
---
# ADR — Source of truth и зеркалирование

## TL;DR

- Notion — единственное место, где редактируется контент и согласуются решения.
- GitHub хранит нормализованное зеркало и публикует его через CI.
- Импорт из Notion всегда проходит через ветку `notion-sync/<date>` + PR + проверки.
- Изменения вне `docs/**` и служебных файлов блокируются рейлами безопасности.

## Контекст

Команда работает в двух средах: Notion удобен для авторинга и обсуждения, GitHub — для автоматизации, версионности и публикации. Без чётких правил возникали случаи, когда правки вносились напрямую в репозиторий, ломали нормализацию и расходились с Notion. Необходимо формализовать поток и инструменты контроля.

## Решение

1. **Единый источник.** Любой текст/структура сначала обновляется в Notion.  
2. **Импорт по правилам.** Экспорт кладём в `uploads/`, запускаем `notion-import.yml`, получаем ветку `notion-sync/...` с PR.  
3. **Рейлы.** `scripts/check-import-safety.mjs` и правила репозитория запрещают изменения вне `docs/**` и разрешённого набора.  
4. **Автопилот.** После мерджа GitHub Actions выполняют нормализацию, линты и публикацию.  
5. **Откаты.** Rollback делаем коммитом в Git (или revert PR), затем при необходимости обновляем Notion ссылкой на итоговую версию.

## Последствия

- Диффы между Notion и GitHub всегда прозрачны: любой конфликт решается в PR.  
- История репозитория остаётся воспроизводимой, что упрощает поиск регрессий и аудит изменений.  
- Экспорт/импорт можно запускать автоматически, не опасаясь незапланированных правок в служебных файлах.

## Контроль изменений
- Любая правка в зеркале идёт через ветку `notion-sync/<date>` + PR.
- Скрипт `scripts/check-import-safety.mjs` проверяет, что diff затрагивает только `docs/**`.
- Если rollback делаем в Git, в Notion добавляем ссылку на commit, чтобы восстановить контекст.

## Связано с…

- [Таксономия и теги](taksonomiya-i-tegi.md)
- [Вова и Петрова](vova-i-petrova.md)
- [Услуги](uslugi.md)
- [Архитектура и компоненты](arhitektura-i-komponenty-486a0b.md)

