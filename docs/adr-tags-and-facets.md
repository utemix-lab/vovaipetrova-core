---
title: ADR — Политика тегов и фасетов
slug: adr-tags-and-facets
summary: 'Фиксируем правила для видимых тегов и machine_tags, чтобы поддерживать единую фасетную модель.'
tags:
  - Проектирование
  - Автоматизация
  - Кодинг
machine_tags:
  - product/services
  - theme/graphics
  - action/build
  - theme/automation
  - theme/dev
status: ready
---
# ADR — Политика тегов и фасетов

## TL;DR

- Видимые теги (`tags[]`) — только `#Title_Case` в тексте и 2–5 значений во фронт-маттере.
- `machine_tags[]` храним исключительно через алиасы в `docs/nav/tags.yaml`.
- Новые видимые теги обязаны появиться в словаре aliases до публикации.
- Автоматические отчёты (`normalize --tags-only`, `report:no-alias`) сигналят о пропущенных соответствиях.

## Контекст

При масштабировании базы знаний теги быстро расходились: разные авторы добавляли синонимы, смешивали кириллицу и латиницу, забывали machine_tags. Это ломало фильтры, искало по частичным совпадениям и делало импорт из Notion нестабильным. Требуется единая политика с понятными ограничениями и автоматическими проверками.

## Решение

1. **Visible vs machine.** Видимые теги — часть текста и фронт-маттера, machine_tags остаются скрытыми и работают только как фасеты.  
2. **Словарь aliases.** Каждому видимому тегу соответствует запись в `docs/nav/tags.yaml`, которая разворачивает его в один или несколько machine_tags.  
3. **Лимиты.** На страницу допускаем 2–5 видимых тегов, чтобы они оставались осмысленными и помогали навигации.  
4. **Normalize.** `scripts/normalize.mjs --tags-only` обновляет `machine_tags[]` и порядок значений, не трогая содержимое.  
5. **Контроль.** `npm run report:no-alias` и CI помечают любые теги без алиасов как предупреждение к исправлению.

## Последствия

- Навигация по фасетам остаётся стабильной, потому что все machine_tags выводятся из одного словаря.  
- Любое расхождение видно до мерджа: отчёт no-alias и линтер подсветят забытые соответствия.  
- Обновление словаря в одном месте автоматически раскатывается на весь `docs/` через `normalize --tags-only`.

## Связано с…

- [Таксономия и теги](taksonomiya-i-tegi.md)
- [Вова и Петрова](vova-i-petrova.md)

