---
title: 'Импорт и безопасность: как мы перестали бояться ZIP'
slug: 03-import-i-bezopasnost
summary: История появления workflow Notion Import и почему он стал обязательным шлюзом.
tags:
  - Story
machine_tags:
  - content/story
status: draft
last_edited_time: 2025-11-14T09:20:00.000Z
---

# Импорт и безопасность: как мы перестали бояться ZIP

TL;DR

- Ручные загрузки грозили перезаписать скрипты, поэтому появился Safe PR workflow.
- Workflow защищает контент и автоматизирует путь от ZIP до PR.
- Action сам создаёт PR с отчётом и метками, если всё прошло гладко.
- Внутри — проверки путей, normalize, fix:links, lint и deny paths.
- Это открыло дорогу к следующему шагу — полному автопилоту.

**Что произошло.** После первых ручных загрузок выяснилось, что любой невнимательный push может перезаписать скрипты или README. Мы собрали отдельный workflow «Notion Import (Safe PR)», который принимает ZIP из `uploads/` или ветки `notion-sync/**`.

**Зачем это делали.** Цель — не дать контенту затереть инфраструктуру и при этом не тормозить брифы. Импорт запускается одной кнопкой, но внутри бегут проверки: распаковка, безопасность путей, normalize, fix:links, lint.

**Что получилось.** Если всё чисто, Action сам создаёт PR, прикладывает `import-diff.md`, ставит лейбл `auto:ready-for-review` и ждёт аппрува. В случае риска включается `needs-fixes`, и ветка не попадает в `main`, пока команда не разберётся.

**Тех-вставка.** Скрипт `scripts/check-import-safety.mjs` проверяет deny paths из `.import-map.yaml`, а шаги Actions используют `actions/checkout@v4.1.1` и `actions/setup-node@v4.0.2` с токеном `GITHUB_TOKEN`. Даже commit message фиксирован: `chore: normalize imported Notion docs [skip ci]`.

**Что дальше.** Мы закрыли базовую гигиену. Следующий барьер — автоматизация после импорта: чтобы PR не ждал Дмитрия часами, а мёржился, как только зелёный Docs CI.

